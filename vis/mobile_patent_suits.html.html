<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script type="text/javascript" src="http://d3js.org/d3.v3.js"></script>
    <script src="http://underscorejs.org/underscore.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.1.js"></script>
</head>
<body>
<style type="text/css">

    .link {
        fill: none;
        stroke: #666;
        stroke-width: 1.5px;
    }

    #owned {
        fill: green;
    }

    .link.owned {
        stroke: green;
    }

    .link.forked {
        stroke-dasharray: 0, 2 1;
    }

    circle {
        fill: #ccc;
        stroke: #333;
        stroke-width: 1.5px;
    }

    text {
        font: 10px sans-serif;
        pointer-events: none;
        text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff;
    }

    body {
        height: 100%;
        padding: 0;
        margin: 0;
    }

</style>

<p><script type="text/javascript"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var repos = [
    {name: &#39;xyz123456&#39;},
    {name: &#39;dfgdfg&#39;},
    {name: &#39;dfgdf&#39;},
    {name: &#39;234234&#39;},
    {name: &#39;d09rtet&#39;},
    {name: &#39;fdgdf03&#39;}
];

_.each(repos, function (x) {
    x.mapping = {
        type: &#39;Repo&#39;
    };
});

var users = [
    {name: &#39;mtford90&#39;, url: &#39;https://avatars2.githubusercontent.com/u/1734057?v=2&amp;s=460&#39;},
    {name: &#39;wallyqs&#39;, url: &#39;https://avatars2.githubusercontent.com/u/26195?v=2&amp;s=460&#39;}
];
_.each(users, function (x) {
    x.mapping = {
        type: &#39;User&#39;
    };
});

var links = [
    {source: users[0], target: repos[0], relationshipType: &quot;owned&quot;},
    {source: users[0], target: repos[1], relationshipType: &quot;owned&quot;},
    {source: users[0], target: repos[2], relationshipType: &quot;owned&quot;},
    {source: users[0], target: repos[3], relationshipType: &quot;owned&quot;},
    {source: users[0], target: repos[4], relationshipType: &quot;owned&quot;},
    {source: users[0], target: repos[5], relationshipType: &quot;owned&quot;},
    {source: repos[2], target: repos[3], relationshipType: &quot;forked&quot;},
    {source: users[1], target: users[0], relationshipType: &#39;follows&#39;}
];

var nodes = {};

// Compute the distinct nodes from the links.
links.forEach(function (link) {
    link.source = nodes[link.source.name] || (nodes[link.source.name] = link.source);
    link.target = nodes[link.target.name] || (nodes[link.target.name] = link.target);
});
console.log(nodes);

var margin = {top: -5, right: -5, bottom: -5, left: -5},
        width = 960,
        height = 500;

var force = d3.layout.force()
        .nodes(d3.values(nodes))
        .links(links)
        .linkDistance(100)
        .charge(-300)
        .on(&quot;tick&quot;, tick)
        .start();


var zoom = d3.behavior.zoom()
        .scaleExtent([1, 10])
        .on(&quot;zoom&quot;, zoomed);


var svg = d3.select(&quot;body&quot;).append(&quot;svg&quot;)
        .attr(&quot;width&quot;, &#39;100%&#39;)
        .attr(&quot;height&quot;, &#39;100%&#39;)
        .attr(&#39;id&#39;, &#39;svg&#39;)
        .append(&quot;g&quot;)
        .attr(&quot;transform&quot;, &quot;translate(&quot; + margin.left + &quot;,&quot; + margin.right + &quot;)&quot;)
        .call(zoom);

var rect = svg.append(&quot;rect&quot;)
        .attr(&quot;width&quot;, &#39;100%&#39;)
        .attr(&quot;height&quot;, &#39;100%&#39;)
        .style(&quot;fill&quot;, &quot;none&quot;)
        .style(&quot;pointer-events&quot;, &quot;all&quot;);

var transx = $(&#39;#svg&#39;).width() / 2;
var transy = $(&#39;#svg&#39;).height() / 2;

var container = svg.append(&quot;g&quot;)
        .attr(&#39;id&#39;, &#39;container&#39;)
        .attr(&quot;transform&quot;, &quot;translate(&quot; + transx + &quot;,&quot; + transy + &quot;)&quot;);

zoom.translate([transx, transy]);


console.log(&#39;container&#39;, container);

// Per-type markers, as they don&#39;t inherit styles.
container.append(&quot;defs&quot;).selectAll(&quot;marker&quot;)
        .data([&quot;ManyToMany&quot;, &quot;owned&quot;, &quot;forked&quot;])
        .enter().append(&quot;marker&quot;)
        .attr(&quot;id&quot;, function (d) { return d; })
        .attr(&quot;viewBox&quot;, &quot;0 -5 10 10&quot;)
        .attr(&quot;refX&quot;, 15)
        .attr(&quot;refY&quot;, -1.5)
        .attr(&quot;markerWidth&quot;, 6)
        .attr(&quot;markerHeight&quot;, 6)
        .attr(&quot;orient&quot;, &quot;auto&quot;)
        .append(&quot;path&quot;)
        .attr(&quot;d&quot;, &quot;M0,-5L10,0L0,5&quot;);

var links = force.links();
console.log(&#39;links&#39;, links);
var path = container.append(&quot;g&quot;).selectAll(&quot;path&quot;)
        .data(links)
        .enter().append(&quot;path&quot;)
        .attr(&quot;class&quot;, function (d) { return &quot;link &quot; + d.relationshipType; });
//            .attr(&quot;marker-end&quot;, function (d) { return &quot;url(#&quot; + d.type + &quot;)&quot;; });


var drag = force.drag()
        .on(&quot;dragstart&quot;, function () {
            console.log(&#39;event...&#39;, d3.event);
            d3.event.sourceEvent.stopPropagation();
        });

//    var circle = container.append(&quot;g&quot;).selectAll(&quot;circle&quot;)
//            .data(force.nodes())
//            .enter().append(&quot;circle&quot;)
//            .attr(&quot;r&quot;, 6)
//            .call(drag);


var circle = container.append(&quot;g&quot;).selectAll(&quot;circle&quot;)
        .data(force.nodes())
        .enter().append(&quot;image&quot;)
        .attr(&#39;height&#39;, 20)
        .attr(&#39;width&#39;, 20)
        .attr(&#39;xlink:href&#39;, function (d) {
            if (d.mapping.type == &#39;Repo&#39;) {
                return &#39;repo.svg&#39;
            }
            else if (d.mapping.type == &#39;User&#39;) {
                return d.url;
            }
        })
        .on(&#39;click&#39;, function () {
            console.log(&#39;clicked!&#39;);
        })
        .call(drag);

var text = container.append(&quot;g&quot;).selectAll(&quot;text&quot;)
        .data(force.nodes())
        .enter().append(&quot;text&quot;)
        .attr(&quot;x&quot;, 8)
        .attr(&quot;y&quot;, &quot;.31em&quot;)
        .text(function (d) { return d.name; });

// Use elliptical arc path segments to doubly-encode directionality.
function tick() {
    path.attr(&quot;d&quot;, linkArc);
    circle.attr(&quot;transform&quot;, transform);
    text.attr(&quot;transform&quot;, transform);
}

function linkArc(d) {
    var dx = d.target.x - d.source.x,
            dy = d.target.y - d.source.y,
            dr = Math.sqrt(dx * dx + dy * dy);
    return &quot;M&quot; + d.source.x + &quot;,&quot; + d.source.y + &quot;A&quot; + dr + &quot;,&quot; + dr + &quot; 0 0,1 &quot; + d.target.x + &quot;,&quot; + d.target.y;
}

function transform(d) {
    return &quot;translate(&quot; + (d.x - 10) + &quot;,&quot; + (d.y - 10) + &quot;)&quot;;
}

function zoomed() {
    console.log(d3.event);
    container.attr(&quot;transform&quot;, &quot;translate(&quot; + d3.event.translate + &quot;)scale(&quot; + d3.event.scale + &quot;)&quot;);
}
</code></pre></div>
<p></script></p>

</body>
</html>